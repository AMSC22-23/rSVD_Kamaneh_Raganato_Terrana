num_threads = 2

int m = 200;
int n = 50;
Mat A = Mat::Random(m, n);

// Elapsed times for the first 10 iterations of the power method
// x0: result obtained with Eigen matrix vector multiplication
// x1: result obtained with mat_vet_multiply
// x3: result obtained with mat_vet_multiply_omp

Elapsed mm eigen: 14 [ms]
Elapsed mm mat_vet_multiply: 39 [ms]
Are x1 and x0 equal? ||x1-x0|| = 2.96938e-16
Elapsed mm mat_vet_multiply_omp: 15 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 2 [ms]
Elapsed mm mat_vet_multiply: 34 [ms]
Are x1 and x0 equal? ||x1-x0|| = 4.2358e-16
Elapsed mm mat_vet_multiply_omp: 15 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 3 [ms]
Elapsed mm mat_vet_multiply: 35 [ms]
Are x1 and x0 equal? ||x1-x0|| = 2.30725e-16
Elapsed mm mat_vet_multiply_omp: 13 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 3 [ms]
Elapsed mm mat_vet_multiply: 34 [ms]
Are x1 and x0 equal? ||x1-x0|| = 3.45647e-16
Elapsed mm mat_vet_multiply_omp: 14 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 2 [ms]
Elapsed mm mat_vet_multiply: 37 [ms]
Are x1 and x0 equal? ||x1-x0|| = 4.08119e-16
Elapsed mm mat_vet_multiply_omp: 15 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 4 [ms]
Elapsed mm mat_vet_multiply: 38 [ms]
Are x1 and x0 equal? ||x1-x0|| = 4.15046e-16
Elapsed mm mat_vet_multiply_omp: 19 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 2 [ms]
Elapsed mm mat_vet_multiply: 34 [ms]
Are x1 and x0 equal? ||x1-x0|| = 3.53749e-16
Elapsed mm mat_vet_multiply_omp: 14 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 4 [ms]
Elapsed mm mat_vet_multiply: 34 [ms]
Are x1 and x0 equal? ||x1-x0|| = 3.26939e-16
Elapsed mm mat_vet_multiply_omp: 10 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 4 [ms]
Elapsed mm mat_vet_multiply: 34 [ms]
Are x1 and x0 equal? ||x1-x0|| = 3.21252e-16
Elapsed mm mat_vet_multiply_omp: 16 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 5 [ms]
Elapsed mm mat_vet_multiply: 34 [ms]
Are x1 and x0 equal? ||x1-x0|| = 4.69692e-16
Elapsed mm mat_vet_multiply_omp: 15 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

******************************************************************
int m = 200;
int n = 50;
Mat A = Mat::Random(m, n);

num_threads = 4;

// Elapsed times for the first 10 iterations of the power method
// x0: result obtained with Eigen matrix vector multiplication
// x1: result obtained with mat_vet_multiply
// x3: result obtained with mat_vet_multiply_omp

Elapsed mm eigen: 3 [ms]
Elapsed mm mat_vet_multiply: 43 [ms]
Are x1 and x0 equal? ||x1-x0|| = 3.09291e-16
Elapsed mm mat_vet_multiply_omp: 21 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 2 [ms]
Elapsed mm mat_vet_multiply: 30 [ms]
Are x1 and x0 equal? ||x1-x0|| = 2.76442e-16
Elapsed mm mat_vet_multiply_omp: 20 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 3 [ms]
Elapsed mm mat_vet_multiply: 31 [ms]
Are x1 and x0 equal? ||x1-x0|| = 3.19895e-16
Elapsed mm mat_vet_multiply_omp: 20 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 2 [ms]
Elapsed mm mat_vet_multiply: 30 [ms]
Are x1 and x0 equal? ||x1-x0|| = 2.53029e-16
Elapsed mm mat_vet_multiply_omp: 19 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 2 [ms]
Elapsed mm mat_vet_multiply: 32 [ms]
Are x1 and x0 equal? ||x1-x0|| = 3.22838e-16
Elapsed mm mat_vet_multiply_omp: 20 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 1 [ms]
Elapsed mm mat_vet_multiply: 32 [ms]
Are x1 and x0 equal? ||x1-x0|| = 2.40427e-16
Elapsed mm mat_vet_multiply_omp: 22 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 2 [ms]
Elapsed mm mat_vet_multiply: 34 [ms]
Are x1 and x0 equal? ||x1-x0|| = 4.25756e-16
Elapsed mm mat_vet_multiply_omp: 23 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 1 [ms]
Elapsed mm mat_vet_multiply: 38 [ms]
Are x1 and x0 equal? ||x1-x0|| = 1.93968e-15
Elapsed mm mat_vet_multiply_omp: 22 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 2 [ms]
Elapsed mm mat_vet_multiply: 37 [ms]
Are x1 and x0 equal? ||x1-x0|| = 1.05083e-15
Elapsed mm mat_vet_multiply_omp: 24 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0

Elapsed mm eigen: 1 [ms]
Elapsed mm mat_vet_multiply: 38 [ms]
Are x1 and x0 equal? ||x1-x0|| = 4.94898e-16
Elapsed mm mat_vet_multiply_omp: 21 [ms]
Are x3 and x0 equal? ||x3-x0|| = 0